<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.korit.trip_planner_back.mapper.ItineraryMapper">

    <!-- ✅ INSERT - 출발지 정보 포함 -->
    <insert id="insert" useGeneratedKeys="true" keyProperty="itinerariesId">
        INSERT INTO itineraries
        VALUES (
            DEFAULT,
            #{userId},
            #{startDate},
            #{endDate},
            #{budget},
            #{transport},
            #{partyType},
            #{totalCost},
            NOW(),
            #{startLocationName},
            #{startLat},
            #{startLon}
        )
    </insert>

    <!-- ✅ SELECT BY ID - 출발지 정보 포함 -->
    <select id="findByItinerariesId" resultType="itinerary">
        SELECT
            itineraries_id,
            user_id,
            start_date,
            end_date,
            budget,
            transport,
            party_type,
            total_cost,
            created_at,
            start_location_name,
            start_lat,
            start_lon
        FROM
            itineraries
        WHERE
            itineraries_id = #{itinerariesId}
    </select>

    <!-- ✅ SELECT ALL - 출발지 정보 포함 -->
    <select id="findAll" resultType="itinerary">
        SELECT
            itineraries_id,
            user_id,
            start_date,
            end_date,
            budget,
            transport,
            party_type,
            total_cost,
            created_at,
            start_location_name,
            start_lat,
            start_lon
        FROM
            itineraries
        ORDER BY
            created_at DESC
    </select>

    <!-- ✅ UPDATE - 출발지 정보 포함 -->
    <update id="update">
        UPDATE itineraries
        SET
            start_date = #{startDate},
            end_date = #{endDate},
            budget = #{budget},
            transport = #{transport},
            party_type = #{partyType},
            total_cost = #{totalCost},
            start_location_name = #{startLocationName},
            start_lat = #{startLat},
            start_lon = #{startLon}
        WHERE
            itineraries_id = #{itinerariesId}
    </update>

    <!-- DELETE - 변경 없음 -->
    <delete id="deleteById">
        DELETE FROM itineraries
        WHERE itineraries_id = #{itinerariesId}
    </delete>

</mapper>